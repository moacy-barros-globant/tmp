*** Reading local file: /usr/local/airflow/logs/etl-verizon-spend-data/verizon_api_to_snowflake/2020-07-24T00:23:05+00:00/2.log
[2020-07-25 00:31:03,929] {{models.py:1359}} INFO - Dependencies all met for <TaskInstance: etl-verizon-spend-data.verizon_api_to_snowflake 2020-07-24T00:23:05+00:00 [queued]>
[2020-07-25 00:31:03,934] {{models.py:1359}} INFO - Dependencies all met for <TaskInstance: etl-verizon-spend-data.verizon_api_to_snowflake 2020-07-24T00:23:05+00:00 [queued]>
[2020-07-25 00:31:03,934] {{models.py:1571}} INFO - 
--------------------------------------------------------------------------------
Starting attempt 2 of 3
--------------------------------------------------------------------------------

[2020-07-25 00:31:03,952] {{models.py:1593}} INFO - Executing <Task(PythonOperator): verizon_api_to_snowflake> on 2020-07-24T00:23:05+00:00
[2020-07-25 00:31:03,952] {{base_task_runner.py:118}} INFO - Running: ['bash', '-c', 'airflow run etl-verizon-spend-data verizon_api_to_snowflake 2020-07-24T00:23:05+00:00 --job_id 12 --raw -sd DAGS_FOLDER/verizon_dag.py --cfg_path /tmp/tmpxym1m86r']
[2020-07-25 00:31:04,682] {{base_task_runner.py:101}} INFO - Job 12: Subtask verizon_api_to_snowflake [2020-07-25 00:31:04,681] {{settings.py:174}} INFO - settings.configure_orm(): Using pool settings. pool_size=5, pool_recycle=1800, pid=3892
[2020-07-25 00:31:05,285] {{base_task_runner.py:101}} INFO - Job 12: Subtask verizon_api_to_snowflake [2020-07-25 00:31:05,285] {{__init__.py:51}} INFO - Using executor LocalExecutor
[2020-07-25 00:31:05,698] {{base_task_runner.py:101}} INFO - Job 12: Subtask verizon_api_to_snowflake [2020-07-25 00:31:05,697] {{models.py:273}} INFO - Filling up the DagBag from /usr/local/airflow/dags/verizon_dag.py
[2020-07-25 00:31:06,706] {{base_task_runner.py:101}} INFO - Job 12: Subtask verizon_api_to_snowflake [2020-07-25 00:31:06,705] {{AirflowHelpers.py:60}} WARNING - E-mail list not set for dag etl-verizon-spend-data. Using default data-eng email.
[2020-07-25 00:31:06,743] {{base_task_runner.py:101}} INFO - Job 12: Subtask verizon_api_to_snowflake [2020-07-25 00:31:06,743] {{cli.py:520}} INFO - Running <TaskInstance: etl-verizon-spend-data.verizon_api_to_snowflake 2020-07-24T00:23:05+00:00 [running]> on host c4e0de7dd17b
[2020-07-25 00:31:06,785] {{python_operator.py:95}} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_ID=etl-verizon-spend-data
AIRFLOW_CTX_TASK_ID=verizon_api_to_snowflake
AIRFLOW_CTX_EXECUTION_DATE=2020-07-24T00:23:05+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2020-07-24T07:00:00+00:00
[2020-07-25 00:31:06,785] {{logging_mixin.py:95}} INFO - schema>>>>>>>: Verizon/spending.json
[2020-07-25 00:31:06,786] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:06,786] {{SDCDataSchema.py:163}} ERROR - Note: The following options are being ignored ['token_url', 'output_schema', 'template_name', 'input_dict'] for api source.
[2020-07-25 00:31:06,786] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:06,786] {{SDCDataSchema.py:174}} INFO - SCHEMA VALIDATION: Done validating top-level endpoint information.
[2020-07-25 00:31:06,786] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:06,786] {{SDCDataSchema.py:334}} INFO - Validating schema parameter dependencies...
[2020-07-25 00:31:06,786] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:06,786] {{SDCDataSchema.py:112}} INFO - Schema passed validation!
[2020-07-25 00:31:07,091] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:07,090] {{SDCAPIEndpoint.py:42}} INFO - API class has successfully been retrieved
[2020-07-25 00:31:07,092] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:07,092] {{SDCDataSchema.py:174}} INFO - SCHEMA VALIDATION: Done validating top-level endpoint information.
[2020-07-25 00:31:07,093] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:07,093] {{SDCDataSchema.py:325}} INFO - SCHEMA VALIDATION: Done validating schema section.
[2020-07-25 00:31:07,093] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:07,093] {{SDCDataSchema.py:334}} INFO - Validating schema parameter dependencies...
[2020-07-25 00:31:07,093] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:07,093] {{SDCDataSchema.py:112}} INFO - Schema passed validation!
[2020-07-25 00:31:07,093] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:07,093] {{SnowflakeDatabase.py:47}} INFO - Snowflake constructor.
[2020-07-25 00:31:07,129] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:07,129] {{SnowflakeDatabase.py:75}} INFO - Connecting to Snowflake.
[2020-07-25 00:31:07,353] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:07,353] {{connection.py:179}} INFO - Snowflake Connector for Python Version: 2.1.1, Python Version: 3.6.10, Platform: Linux-4.19.76-linuxkit-x86_64-with-debian-10.4
[2020-07-25 00:31:07,354] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:07,353] {{connection.py:804}} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2020-07-25 00:31:09,391] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:09,389] {{cursor.py:519}} INFO - query: [SELECT CAST('test plain returns' AS VARCHAR(60)) AS anon_1]
[2020-07-25 00:31:11,657] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:11,657] {{cursor.py:545}} INFO - query execution done
[2020-07-25 00:31:11,658] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:11,658] {{cursor.py:519}} INFO - query: [SELECT CAST('test unicode returns' AS VARCHAR(60)) AS anon_1]
[2020-07-25 00:31:11,925] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:11,925] {{cursor.py:545}} INFO - query execution done
[2020-07-25 00:31:11,926] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:11,926] {{cursor.py:519}} INFO - query: [ROLLBACK]
[2020-07-25 00:31:13,343] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:13,343] {{cursor.py:545}} INFO - query execution done
[2020-07-25 00:31:13,344] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:13,343] {{SnowflakeDatabase.py:109}} INFO - Connected to Snowflake.
[2020-07-25 00:31:13,742] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:13,742] {{VerizonAPI.py:369}} WARNING - Response payload: 
{
  "status": 401,
  "message": "HTTP 401 Unauthorized",
  "requestId": "1595637073656-a1b-41-t1",
  "requestUrl": "http://api-sched-v3.admanagerplus.yahoo.com/yamplus_api/extreport/",
  "requestBody": ""
}
[2020-07-25 00:31:13,743] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:13,743] {{VerizonAPI.py:370}} WARNING - Trying to refresh access token...
[2020-07-25 00:31:14,633] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:14,633] {{VerizonAPI.py:154}} INFO - 200
[2020-07-25 00:31:17,267] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:17,267] {{VerizonAPI.py:265}} INFO - 2020-07-25 00:31:17.267427 : 0 : Submitted : None + 
 
                    ReportSubmissionStatus(
                            customerReportId: 0d89e127-9025-46ab-a79f-0fa888ef2b94
                            status: Submitted
                            url: None
                            reportFormat: None
                            requestPayload: {"startDate":"2020-07-23T00:00:00+00:00","endDate":"2020-07-23T23:59:59+00:00","dateTypeId":11,"reportOption":{"timezone":"Etc/GMT","metricTypeIds":[1,2,44,23,109,110],"currency":4,"dimensionTypeIds":[5,6,7,8,46]},"intervalTypeId":2}
                            jobStartDate: None
                            jobEndDate: None
                            numRows: None
                            errorMsg: None
                    )
[2020-07-25 00:31:32,558] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:32,558] {{VerizonAPI.py:265}} INFO - 2020-07-25 00:31:32.558042 : 1 : Submitted : None + 
 
                    ReportSubmissionStatus(
                            customerReportId: 0d89e127-9025-46ab-a79f-0fa888ef2b94
                            status: Success
                            url: https://s.yimg.com/da/extrep9132137369728057652.csv
                            reportFormat: CSV
                            requestPayload: {"startDate":"2020-07-23T00:00:00+00:00","endDate":"2020-07-23T23:59:59+00:00","dateTypeId":11,"reportOption":{"timezone":"Etc/GMT","metricTypeIds":[1,2,44,23,109,110],"currency":4,"dimensionTypeIds":[5,6,7,8,46]},"intervalTypeId":2}
                            jobStartDate: 2020-07-24T17:31:22.000-07:00
                            jobEndDate: 2020-07-24T17:31:23.000-07:00
                            numRows: 1852
                            errorMsg: None
                    )
[2020-07-25 00:31:33,505] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:33,504] {{VerizonAPI.py:338}} INFO - Loading schema Verizon/spending
[2020-07-25 00:31:33,965] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:33,965] {{Dataframe.py:610}} INFO - Shape of dataframe: (1852, 18)
[2020-07-25 00:31:33,965] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:33,965] {{Dataframe.py:712}} INFO - Writing to table...
[2020-07-25 00:31:34,000] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:33,999] {{cursor.py:519}} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ "VERIZON"."SPEND_DATA"]
[2020-07-25 00:31:35,116] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:35,116] {{cursor.py:545}} INFO - query execution done
[2020-07-25 00:31:35,524] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:35,524] {{cursor.py:519}} INFO - query: [INSERT INTO "VERIZON"."SPEND_DATA" ("DATE", "ORDER_ID", "ORDER", "LINE_ID", "LIN...]
[2020-07-25 00:31:40,035] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:40,035] {{cursor.py:545}} INFO - query execution done
[2020-07-25 00:31:40,038] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:40,038] {{cursor.py:519}} INFO - query: [COMMIT]
[2020-07-25 00:31:42,560] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:42,560] {{cursor.py:545}} INFO - query execution done
[2020-07-25 00:31:42,561] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:42,561] {{cursor.py:519}} INFO - query: [SHOW /* sqlalchemy:get_table_names */ TABLES IN "VERIZON"]
[2020-07-25 00:31:42,925] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:42,925] {{cursor.py:545}} INFO - query execution done
[2020-07-25 00:31:42,929] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:42,929] {{json_result.py:116}} INFO - fetching data done
[2020-07-25 00:31:42,932] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:42,931] {{cursor.py:519}} INFO - query: [SHOW /* sqlalchemy:_get_schema_primary_keys */PRIMARY KEYS IN SCHEMA dataenginee...]
[2020-07-25 00:31:43,246] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:43,245] {{cursor.py:545}} INFO - query execution done
[2020-07-25 00:31:43,247] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:43,247] {{json_result.py:116}} INFO - fetching data done
[2020-07-25 00:31:43,248] {{logging_mixin.py:95}} INFO - [2020-07-25 00:31:43,248] {{cursor.py:519}} INFO - query: [SELECT /* sqlalchemy:_get_columns_in_schema */ ic.table_name, ic.column_name, ic...]